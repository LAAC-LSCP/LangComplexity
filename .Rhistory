all_data$Age3=all_data$Age^3 #generate cubic component
all_data<-subset(all_data, !is.na(Maddieson_VQ)) #exclude NA Vowels
all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, C_count, Maddieson_C_inv, V_count, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
#IMPORTANT: run the first line in case of the analysis of Consonants and
#second one in case of analysis of Vowels
all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
all_data<-subset(all_data, !is.na(Maddieson_VQ)) #exclude NA Vowels
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, C_count, Maddieson_C_inv, V_count, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
all_data$coding<-ifelse(all_data$corpus %in% c("Solomon","French"),"lab","citsci")
View(all_data)
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, C_count, Maddieson_C_inv, V_count, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
all_data$coding<-ifelse(all_data$corpus %in% c("Solomon","French"),"lab","citsci")
all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, C_count, Maddieson_C_inv, V_count, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
#ISSUE:  This way exclude more data than it's supposed to -> SOLVE IT later
#all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
#all_data<-subset(all_data, !is.na(Maddieson_VQ)) #exclude NA Vowels
# add more information
all_data$coding<-ifelse(all_data$corpus %in% c("Solomon","French"),"lab","citsci")
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, C_count, Maddieson_C_inv, V_count, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
all_data$coding<-ifelse(all_data$corpus %in% c("Solomon","French"),"lab","citsci")
table(all_data$corpus)
table(all_data$Language) #shows N kids per language
table(all_data$Maddieson_C,all_data$Language) #Consonants
table(all_data$Maddieson_VQ,all_data$Language) #Vowels
table(all_data$Language,all_data$Maddieson_C,all_data$SylComp) #Consonants
table(all_data$Language,all_data$Maddieson_VQ,all_data$SylComp) #Vowels
hist(all_data$CR,main="CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Small"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Mod. Small"],main="Consonants and CR",xlab="CR")
View(all_data)
ibrary(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub<-lang_data %>% select(Language, Maddieson_C, Maddieson_C_inv, Maddieson_VQ, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub <-lang_data %>% select(Language, Maddieson_C, Maddieson_C_inv, Maddieson_VQ, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
View(lang_data)
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub <-lang_data %>% select(Language, Maddieson_C_inv, Maddieson_VQ, Maddieson_VQ_Inv, Maddieson_sylcomp)
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub <-lang_data %>% select(Language, Maddieson_C_inv, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
summary(all_data)
dim(all_data)
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C=factor(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ=factor(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
View(all_data)
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub <-lang_data %>% select(Language, Maddieson_C_inv, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
View(all_data)
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C <- ordered(all_data$Maddieson_C_inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Maddieson_VQ <- ordered(all_data$Maddieson_VQ_Inv,levels=c("Small", "Mod. Small","Average","Mod. Large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
library(tidyverse)
library(ggplot2)
library(gvlma)
library(car)
library(RCurl)
##DATASET WITH CR ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vSzvJcT6yT9_fpRoFg5O7LAput7VKKltSxAuGMyC5wDlo_75D9ELA8YaVeMIVwcLw/pub?output=csv'
#myfile <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data<- read.csv(textConnection(myfile), header=T)
#CSV. file
CR_data<- read.csv("./Data/CR_by_child.csv", header=T,sep=",")
#an error can be solved by using ";" or "," as a separator
#DATASET WITH LANGUAGE PROPERTIES ---------------------------------
#Google Spreadsheet
#docloc='https://docs.google.com/spreadsheets/d/e/2PACX-1vQn5BpGr0eAcfpuf0F-No0_pJ9QgVk4i79ryOS4OI53kw7waB-OuBLMozF1hiFdNQ/pub?output=csv'
#myfile2 <- getURL(docloc, ssl.verifyhost=FALSE, ssl.verifypeer=FALSE)
#all_data2<- read.csv(textConnection(myfile2), header=T)
#CSV. file
#adding a file with Languages file
lang_data<- read.csv("./Data/LAAC_Internship2020_Languages.csv", header=T,sep=",")
#MERGING TWO DATASETS TOGETHER
#select the columns to merge from the Languages file
lang_sub <-lang_data %>% select(Language, Maddieson_C_inv, Maddieson_VQ_Inv, Maddieson_sylcomp)
#merge the selected columns into one dataset
all_data<-merge(CR_data,lang_sub, by="Language")
#FINAL DATASET  ---------------------------------
summary(all_data)
dim(all_data)
#CORRECTING DATA  ---------------------------------
all_data$CR=as.numeric(gsub(",",".",all_data$CR))
all_data$Maddieson_C <- ordered(all_data$Maddieson_C_inv,levels=c("Small", "Moderately Small","Average","Moderately large", "Large"))
all_data$Maddieson_VQ <- ordered(all_data$Maddieson_VQ_Inv,levels=c("Small", "Moderately Small","Average","Moderately large", "Large"))
all_data$Age=as.numeric(gsub(",",".",all_data$Age.in.months))
all_data$Age2=all_data$Age^2 #generate squared component
all_data$Age3=all_data$Age^3 #generate cubic component
View(all_data)
all_data<-subset(all_data, !is.na(Maddieson_C)) #exclude NA in Consonants
all_data<-subset(all_data, !is.na(Maddieson_VQ)) #exclude NA Vowels
# add more information
all_data$coding<-ifelse(all_data$corpus %in% c("Solomon","French"),"lab","citsci")
hist(all_data$CR[all_data$Maddieson_C=="Small"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Moderately Small"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Average"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Moderately Large"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Moderately large"],main="Consonants and CR",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Moderately Small"],main="Consonants: Moderately Small",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Average"],main="Consonants: Average",xlab="CR")
hist(all_data$CR[all_data$Maddieson_C=="Moderately large"],main="Consonants: Moderately Large",xlab="CR")
hist(all_data$CR[all_data$Maddieson_VQ=="Average"],main="Vowels: Average",xlab="CR")
hist(all_data$CR[all_data$Maddieson_VQ=="Large"],main="Vowels: Moderately Large",xlab="CR")
hist(all_data$CR[all_data$Maddieson_VQ=="Average"],main="Vowels: Average",xlab="CR")
hist(all_data$CR[all_data$Maddieson_VQ=="Large"],main="Vowels: Large",xlab="CR")
ggplot(all_data,aes(x=CR,fill=Maddieson_C))+      #Consonants
geom_histogram(bins=20,color="black") +
facet_grid(.~Maddieson_C)
ggplot(all_data,aes(x=CR,fill=Maddieson_VQ))+      #Vowels
geom_histogram(bins=20,color="black") +
facet_grid(.~Maddieson_VQ)
ggplot(all_data, aes(x=Age, y=CR, color=Language)) +
geom_point()+
# Add regression lines
geom_smooth(method=lm,se=FALSE)
mod_complexC=lm(CR~Age*Maddieson_C+Age2*Maddieson_C+Age3*Maddieson_C,data=all_data) #Consonants
mod_complexV=lm(CR~Age*Maddieson_VQ+Age2*Maddieson_VQ+Age3*Maddieson_VQ,data=all_data) #Vowels
plot(mod_complexC)
#compare to simpler model
#Consonants
mod_simpleC=lm(CR~Age+Maddieson_C,data=all_data)
anova(mod_complexC,mod_simpleC)
mod_simpleV=lm(CR~Age+Maddieson_VQ,data=all_data)
anova(mod_complexV,mod_simpleV)
mod_age=lm(CR~Age+Age2+Age3,data=all_data)
anova(mod_complexC,mod_age) #Consonants
anova(mod_complexV,mod_age)
mod_intC=lm(CR~Age*Maddieson_C,data=all_data)
anova(mod_complexC,mod_intC)
#Vowels
mod_intV=lm(CR~Age*Maddieson_VQ,data=all_data)
anova(mod_complexV,mod_intV)
mod_int_ageC=lm(CR~Age*Maddieson_C+Age2+Age3,data=all_data)
anova(mod_complexC,mod_int_ageC)
#Vowels
mod_int_ageV=lm(CR~Age*Maddieson_VQ+Age2+Age3,data=all_data)
anova(mod_complexV,mod_int_ageV)
mod_int_ageC2=lm(CR~Age*Maddieson_C+Age2,data=all_data)
anova(mod_int_ageC,mod_int_ageC2) #and age cube doesn't add anything either
#Vowels
mod_int_ageV2=lm(CR~Age*Maddieson_VQ+Age2,data=all_data)
anova(mod_int_ageV,mod_int_ageV2)
od_int_age2_intC=lm(CR~Age*Maddieson_C+Age2*Maddieson_C,data=all_data)
anova(mod_complexC,mod_int_age2_intC) #ah note that the interaction age3*sylcomp wasn't adding anything
#Vowels
mod_int_age2_intV=lm(CR~Age*Maddieson_VQ+Age2*Maddieson_VQ,data=all_data)
mod_int_age2_intC=lm(CR~Age*Maddieson_C+Age2*Maddieson_C,data=all_data)
anova(mod_complexC,mod_int_age2_intC) #ah note that the interaction age3*sylcomp wasn't adding anything
#Vowels
mod_int_age2_intV=lm(CR~Age*Maddieson_VQ+Age2*Maddieson_VQ,data=all_data)
anova(mod_complexV,mod_int_age2_intV)
plot(mod_int_age2_intC)
plot(mod_int_age2_intC)
Anova(mod_int_age2_intC, type="III")
summary(mod_int_age2_intC)
#Vowels
Anova(mod_int_age2_intV, type="III")
summary(mod_int_age2_intV)
mod_int_age_noTsiC=lm(CR~Age*Maddieson_C+Age2*Maddieson_C,data=all_data,subset=c(corpus!="Tsimane"))
plot(mod_int_age_noTsiC)
gvlma(mod_int_age_noTsiV)
summary(mod_int_age2_intV)
#Consonants
mod_int_age_noTsiC=lm(CR~Age*Maddieson_C+Age2*Maddieson_C,data=all_data,subset=c(corpus!="Tsimane"))
plot(mod_int_age_noTsiC)
gvlma(mod_int_age_noTsiV)
#Consonants
Anova(mod_int_age_noTsiC, type="III")
summary(mod_int_age_noTsiC)
#Vowels
Anova(mod_int_age_noTsiV, type="III")
summary(mod_int_age_noTsiV)
#results are not driven by Tsimane
mod_int_age_noTsiV=lm(CR~Age*Maddieson_VQ+Age2*Maddieson_VQ,data=all_data,subset=c(corpus!="Tsimane"))
plot(mod_int_age_noTsiV)
# geom_smooth(method=lm)+
# Add loess lines
geom_smooth(span = 0.8)
#Vowels
ggplot(all_data_under40, aes(x=Age, y=CR, color=Maddieson_VQ)) +
geom_point()+
# Add regression lines
# geom_smooth(method=lm)+
# Add loess lines
geom_smooth(span = 0.8)
all_data_under40=subset(all_data, Age<40 & corpus!="Warlaumont")
# plot data
#Consonants
ggplot(all_data_under40, aes(x=Age, y=CR, color=Maddieson_C)) +
geom_point()+
# Add regression lines
# geom_smooth(method=lm)+
# Add loess lines
geom_smooth(span = 0.8)
#Vowels
ggplot(all_data_under40, aes(x=Age, y=CR, color=Maddieson_VQ)) +
geom_point()+
# Add regression lines
# geom_smooth(method=lm)+
# Add loess lines
geom_smooth(span = 0.8)
